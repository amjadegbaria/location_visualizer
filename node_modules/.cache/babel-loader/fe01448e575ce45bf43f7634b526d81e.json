{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\AMJADE\\\\Rabea\\\\new-app\\\\src\\\\App.js\";\nimport React, { Component } from 'react';\nimport Header from './Components/Layouts/Header';\nimport Layouts from './Components/Layouts';\nimport axios from 'axios';\nimport './app.scss';\n\nclass App extends Component {\n  constructor() {\n    super(); //this.FramedData=this.FramesByTime()\n    //const Defultdata=this.Frames(6, '2016-04-01', 9)\n\n    this.loadPoints = () => {\n      axios.get('http://localhost:3001/api/getPoints').then(({\n        data\n      }) => {\n        this.setState({\n          fkd: data\n        });\n      }).catch(err => {\n        alert(err);\n      });\n    };\n\n    this.addPoint = () => {\n      axios.post('http://localhost:3001/api/putData', {\n        id_number: 10000064,\n        badge_type_desc: \"Inf RN\",\n        start_date: 1451902509000,\n        end_date: 1451902662000,\n        x: 276.2283570392,\n        y: 995.8385104472,\n        room: \"605\",\n        floor_id: 6,\n        x_start_time: \"10:15:09\",\n        x_end_time: \"10:17:42\"\n      });\n    };\n\n    this.FramesByTime = data => {\n      const dataByTime = {};\n      data && data.forEach(point => {\n        if (point.room_num !== null) {\n          const {\n            floor_id,\n            sTime,\n            eTime\n          } = point;\n          var start = new Date(`October 13, 2014 ${sTime}`);\n          var end = new Date(`October 13, 2014 ${eTime}`);\n\n          while (start < end) {\n            //('it-IT')\n            var time = start.toLocaleTimeString('it-IT', {\n              hour: '2-digit',\n              minute: '2-digit',\n              second: '2-digit',\n              hour12: false\n            }) + '_' + floor_id;\n            dataByTime[time] = dataByTime[time] ? [...dataByTime[time], point] : [point];\n            start.setSeconds(start.getSeconds() + 1);\n          }\n        }\n      });\n      return dataByTime;\n    };\n\n    this.isIntervalIncluded = (time, point) => {\n      const generatedHour = time + ':00:00';\n      const nextHour = time + 1 + ':00:00';\n      const currentDate = new Date(`October 13, 2014 ${generatedHour}`);\n      const nextDate = new Date(`October 13, 2014 ${nextHour}`);\n      const startTime = new Date(`October 13, 2014 ${point.x_start_time}`);\n      const endTime = new Date(`October 13, 2014 ${point.x_end_time}`);\n      return startTime >= currentDate && startTime <= nextDate || endTime >= currentDate && endTime <= nextDate;\n    };\n\n    this.Frames = (floor, date, time) => {\n      const generatedHour = time + ':00:00';\n      const nextHour = time + 1 + ':00:00';\n      const currentTime = new Date(`October 13, 2014 ${generatedHour}`);\n      const nextTime = new Date(`October 13, 2014 ${nextHour}`);\n      var matchingKeys = [];\n\n      while (currentTime < nextTime) {\n        const key = currentTime.toLocaleTimeString('it-IT') + '_' + floor;\n        matchingKeys.push(key);\n        currentTime.setMinutes(currentTime.getMinutes() + 1);\n      }\n\n      const data = this.FramedData;\n      const matchingFrames = {};\n      matchingKeys.map(function (key) {\n        data[key] && (matchingFrames[key] = data[key]);\n      });\n      return matchingFrames;\n    };\n\n    this.getDataByFloor = (floor_id, current = 1451898000, next = 1451901600) => {\n      axios.get('http://localhost:3001/api/getPointsByFloor', {\n        params: {\n          floor_id,\n          current,\n          next\n        }\n      }).then(({\n        data\n      }) => {\n        this.setState({\n          data,\n          selectedData: data //this.FramesByTime(data)\n\n        });\n      }).catch(err => {\n        alert(err);\n      });\n    };\n\n    this.handleOnSearch = (floor, date, time) => {\n      // const newData = data.filter(point => point.floor_id === floor && this.isIntervalIncluded(time, point) && point.Room!=null);\n      const generatedHour = time + ':00:00';\n      const nextHour = time + 1 + ':00:00';\n      const currentTime = this.toTimestamp(date, generatedHour);\n      const nextTime = this.toTimestamp(date, nextHour);\n      this.getDataByFloor(floor, currentTime, nextTime);\n    };\n\n    this.state = {\n      data: this.getDataByFloor(6),\n      hr: 9,\n      fkd: '',\n      selectedData: null\n    };\n  }\n\n  toTimestamp(date, time) {\n    const currentTime = new Date(date + ' ' + time + ' GMT');\n    var datum = Date.parse(currentTime);\n    return datum / 1000;\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"app\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      handleOnSearch: this.handleOnSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Layouts, {\n      data: this.state.selectedData,\n      time: this.state.hr,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/AMJADE/Rabea/new-app/src/App.js"],"names":["React","Component","Header","Layouts","axios","App","constructor","loadPoints","get","then","data","setState","fkd","catch","err","alert","addPoint","post","id_number","badge_type_desc","start_date","end_date","x","y","room","floor_id","x_start_time","x_end_time","FramesByTime","dataByTime","forEach","point","room_num","sTime","eTime","start","Date","end","time","toLocaleTimeString","hour","minute","second","hour12","setSeconds","getSeconds","isIntervalIncluded","generatedHour","nextHour","currentDate","nextDate","startTime","endTime","Frames","floor","date","currentTime","nextTime","matchingKeys","key","push","setMinutes","getMinutes","FramedData","matchingFrames","map","getDataByFloor","current","next","params","selectedData","handleOnSearch","toTimestamp","state","hr","datum","parse","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport Header from './Components/Layouts/Header';\nimport Layouts from './Components/Layouts'\nimport axios from 'axios';\nimport './app.scss';\n\nclass App extends Component{\n    constructor(){\n        super()\n        //this.FramedData=this.FramesByTime()\n        //const Defultdata=this.Frames(6, '2016-04-01', 9)\n        this.state={\n\n            data: this.getDataByFloor(6),\n            hr: 9,\n            fkd:'',\n            selectedData: null,\n        }\n    }\n\n    loadPoints = () => {\n        axios.get('http://localhost:3001/api/getPoints')\n            .then(({ data }) => {\n                this.setState({\n                    fkd: data,\n                })\n            })\n            .catch((err) => {\n                alert(err)\n            });\n    }\n    addPoint = () => {\n        axios.post('http://localhost:3001/api/putData', {\n            id_number: 10000064,\n            badge_type_desc: \"Inf RN\",\n            start_date: 1451902509000,\n            end_date: 1451902662000,\n            x: 276.2283570392,\n            y: 995.8385104472,\n            room: \"605\",\n            floor_id: 6,\n            x_start_time: \"10:15:09\",\n            x_end_time: \"10:17:42\"\n        });\n    }\n    \n    FramesByTime = (data) => {\n        const dataByTime = {};\n        data && data.forEach((point)=> {\n            if (point.room_num !== null){\n                const { floor_id, sTime, eTime}=point\n                var start=new Date(`October 13, 2014 ${sTime}`)\n                var end=new Date(`October 13, 2014 ${eTime}`)\n                while (start < end) {\n                    //('it-IT')\n                    var time=start.toLocaleTimeString(('it-IT'), {hour: '2-digit', minute:'2-digit',second: '2-digit',hour12: false})+'_'+ floor_id\n                    dataByTime[time]=dataByTime[time] ? [...dataByTime[time],point] : [point]\n                    start.setSeconds(start.getSeconds() + 1);\n                }\n            }   \n         })\n        return dataByTime\n    }\n    isIntervalIncluded = (time, point) => {\n        const generatedHour = time + ':00:00';\n        const nextHour = (time+1) + ':00:00';\n        const currentDate = new Date(`October 13, 2014 ${generatedHour}`);\n        const nextDate = new Date(`October 13, 2014 ${nextHour}`);\n        const startTime = new Date(`October 13, 2014 ${point.x_start_time}`);\n        const endTime = new Date(`October 13, 2014 ${point.x_end_time}`);\n        return (startTime >= currentDate && startTime <= nextDate) ||\n            (endTime >= currentDate && endTime <= nextDate);\n    };\n    Frames = (floor, date, time) =>{\n        const generatedHour = time + ':00:00';\n        const nextHour = (time+1) + ':00:00';\n        const currentTime = new Date(`October 13, 2014 ${generatedHour}`);\n        const nextTime = new Date(`October 13, 2014 ${nextHour}`);\n        var matchingKeys=[]\n        while (currentTime < nextTime) {\n            const key=currentTime.toLocaleTimeString(('it-IT'))+'_'+ floor\n            matchingKeys.push(key)\n            currentTime.setMinutes(currentTime.getMinutes() + 1);\n        }\n        const data=this.FramedData\n        const matchingFrames = {}\n        matchingKeys.map(function(key){ \n            (data[key]) && (matchingFrames[key]= data[key])\n        });\n        return matchingFrames\n    }\n\n    getDataByFloor = (floor_id, current= 1451898000, next=1451901600) => {\n        axios.get('http://localhost:3001/api/getPointsByFloor',{\n            params: {floor_id, current, next}\n        })\n            .then(({ data }) => {\n\n                this.setState({\n                    data,\n                    selectedData: data //this.FramesByTime(data)\n                })\n            })\n            .catch((err) => {\n                alert(err)\n            });\n    }\n    toTimestamp(date, time){\n        const currentTime = new Date(date +' '+ time + ' GMT');\n        var datum = Date.parse(currentTime);\n        return datum/1000;\n    }\n    handleOnSearch = (floor, date, time) => {\n        // const newData = data.filter(point => point.floor_id === floor && this.isIntervalIncluded(time, point) && point.Room!=null);\n        const generatedHour = time + ':00:00';\n        const nextHour = (time+1) + ':00:00';\n        const currentTime = this.toTimestamp(date,generatedHour)\n        const nextTime = this.toTimestamp(date,nextHour)\n        this.getDataByFloor(floor, currentTime, nextTime)\n    };\n    \n    render(){\n        return(\n            <div className='app'>\n                <Header handleOnSearch={this.handleOnSearch}/>\n                <Layouts  data={this.state.selectedData} time={this.state.hr}/>\n            </div>)\n    }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}